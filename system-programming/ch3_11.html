<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>fcntl function</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../intro.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../todo.html">TODO</a></li><li class="chapter-item expanded affix "><li class="part-title">程式設計（programming design）</li><li class="chapter-item expanded "><a href="../programming-design/ch1_0.html"><strong aria-hidden="true">1.</strong> I/O</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../programming-design/ch1_1.html"><strong aria-hidden="true">1.1.</strong> format</a></li><li class="chapter-item expanded "><a href="../programming-design/ch1_2.html"><strong aria-hidden="true">1.2.</strong> input</a></li><li class="chapter-item expanded "><a href="../programming-design/ch1_3.html"><strong aria-hidden="true">1.3.</strong> output</a></li></ol></li><li class="chapter-item expanded "><a href="../programming-design/ch2_0.html"><strong aria-hidden="true">2.</strong> type</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../programming-design/ch2_1.html"><strong aria-hidden="true">2.1.</strong> declare</a></li><li class="chapter-item expanded "><a href="../programming-design/ch2_2.html"><strong aria-hidden="true">2.2.</strong> const</a></li><li class="chapter-item expanded "><a href="../programming-design/ch2_3.html"><strong aria-hidden="true">2.3.</strong> static</a></li></ol></li><li class="chapter-item expanded "><a href="../programming-design/ch3_0.html"><strong aria-hidden="true">3.</strong> flow</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../programming-design/ch3_1.html"><strong aria-hidden="true">3.1.</strong> if else</a></li><li class="chapter-item expanded "><a href="../programming-design/ch3_2.html"><strong aria-hidden="true">3.2.</strong> switch</a></li><li class="chapter-item expanded "><a href="../programming-design/ch3_3.html"><strong aria-hidden="true">3.3.</strong> ternary operator</a></li></ol></li><li class="chapter-item expanded "><a href="../programming-design/ch4_0.html"><strong aria-hidden="true">4.</strong> loop</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../programming-design/ch4_1.html"><strong aria-hidden="true">4.1.</strong> for</a></li><li class="chapter-item expanded "><a href="../programming-design/ch4_2.html"><strong aria-hidden="true">4.2.</strong> while</a></li><li class="chapter-item expanded "><a href="../programming-design/ch4_3.html"><strong aria-hidden="true">4.3.</strong> do while</a></li></ol></li><li class="chapter-item expanded "><a href="../programming-design/ch5_0.html"><strong aria-hidden="true">5.</strong> function</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../programming-design/ch5_1.html"><strong aria-hidden="true">5.1.</strong> declare</a></li><li class="chapter-item expanded "><a href="../programming-design/ch5_2.html"><strong aria-hidden="true">5.2.</strong> recursive</a></li></ol></li><li class="chapter-item expanded "><a href="../programming-design/ch6_0.html"><strong aria-hidden="true">6.</strong> pointer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../programming-design/ch6_1.html"><strong aria-hidden="true">6.1.</strong> declare</a></li><li class="chapter-item expanded "><a href="../programming-design/ch6_2.html"><strong aria-hidden="true">6.2.</strong> refrence &amp; dereference</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> string</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">7.1.</strong> functions 1</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.2.</strong> functions 2</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> memory</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> address</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.2.</strong> dispatch</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> bitwise</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">9.1.</strong> operation</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.2.</strong> useful example</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> advanced type</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.</strong> advanced function</div></li><li class="chapter-item expanded affix "><li class="part-title">系統程式（system programming）</li><li class="chapter-item expanded "><a href="../system-programming/ch1_0.html"><strong aria-hidden="true">12.</strong> unix system overview</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../system-programming/ch1_1.html"><strong aria-hidden="true">12.1.</strong> shell</a></li><li class="chapter-item expanded "><a href="../system-programming/ch1_2.html"><strong aria-hidden="true">12.2.</strong> file and directory</a></li><li class="chapter-item expanded "><a href="../system-programming/ch1_3.html"><strong aria-hidden="true">12.3.</strong> input and output</a></li><li class="chapter-item expanded "><a href="../system-programming/ch1_4.html"><strong aria-hidden="true">12.4.</strong> program and process</a></li><li class="chapter-item expanded "><a href="../system-programming/ch1_5.html"><strong aria-hidden="true">12.5.</strong> user identification</a></li><li class="chapter-item expanded "><a href="../system-programming/ch1_6.html"><strong aria-hidden="true">12.6.</strong> time value</a></li></ol></li><li class="chapter-item expanded "><a href="../system-programming/ch3_0.html"><strong aria-hidden="true">13.</strong> file i/o</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../system-programming/ch3_1.html"><strong aria-hidden="true">13.1.</strong> file descriptors</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_2.html"><strong aria-hidden="true">13.2.</strong> open function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_3.html"><strong aria-hidden="true">13.3.</strong> creat function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_4.html"><strong aria-hidden="true">13.4.</strong> close function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_5.html"><strong aria-hidden="true">13.5.</strong> lseek function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_6.html"><strong aria-hidden="true">13.6.</strong> read function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_7.html"><strong aria-hidden="true">13.7.</strong> write function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_8.html"><strong aria-hidden="true">13.8.</strong> file sharing</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_9.html"><strong aria-hidden="true">13.9.</strong> dup and dup2 function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_10.html"><strong aria-hidden="true">13.10.</strong> sync fsync and fdatasync function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_11.html" class="active"><strong aria-hidden="true">13.11.</strong> fcntl function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch3_12.html"><strong aria-hidden="true">13.12.</strong> ioctl function</a></li></ol></li><li class="chapter-item expanded "><a href="../system-programming/ch4_0.html"><strong aria-hidden="true">14.</strong> files and diectories</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../system-programming/ch4_1.html"><strong aria-hidden="true">14.1.</strong> stat function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_2.html"><strong aria-hidden="true">14.2.</strong> file type</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_3.html"><strong aria-hidden="true">14.3.</strong> set uid &amp; set gid</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_4.html"><strong aria-hidden="true">14.4.</strong> file access permision</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_5.html"><strong aria-hidden="true">14.5.</strong> access and faccessat function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_6.html"><strong aria-hidden="true">14.6.</strong> umask function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_7.html"><strong aria-hidden="true">14.7.</strong> chmod, fchmod, and fchmodat function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_8.html"><strong aria-hidden="true">14.8.</strong> file truncation</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_9.html"><strong aria-hidden="true">14.9.</strong> link, linkat, unlink, unlinkat, and remove function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_10.html"><strong aria-hidden="true">14.10.</strong> rename and renameat function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_11.html"><strong aria-hidden="true">14.11.</strong> sybolic links</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_12.html"><strong aria-hidden="true">14.12.</strong> file time</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_13.html"><strong aria-hidden="true">14.13.</strong> futimens, utimensat, and utimes function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_14.html"><strong aria-hidden="true">14.14.</strong> mkdir, mkdirat, and rmdir function</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_15.html"><strong aria-hidden="true">14.15.</strong> reading diectories</a></li><li class="chapter-item expanded "><a href="../system-programming/ch4_16.html"><strong aria-hidden="true">14.16.</strong> chdir, fchdir, and getcwd function</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">離散數學（discrete math） --testing</li><li class="chapter-item expanded "><a href="../discrete_mathmatics/chapter_1.html"><strong aria-hidden="true">15.</strong> test</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="fcntl-function"><a class="header" href="#fcntl-function">fcntl function</a></h1>
<hr />
<h3 id="fnctl"><a class="header" href="#fnctl">fnctl</a></h3>
<pre><code class="language-c">#include &lt;fcntl.h&gt;
int fcntl(int fd, int cmd, ... /* int arg */ );
</code></pre>
<p>Returns: depends on cmd if OK (see following), −1 on error</p>
<h3 id="purpose"><a class="header" href="#purpose">purpose</a></h3>
<p>The fcntl function is used for five different purposes.</p>
<ol>
<li>Duplicate an existing descriptor (cmd = F_DUPFD or F_DUPFD_CLOEXEC)</li>
<li>Get/set file descriptor flags (cmd = F_GETFD or F_SETFD)</li>
<li>Get/set file status flags (cmd = F_GETFL or F_SETFL)</li>
<li>Get/set asynchronous I/O ownership (cmd = F_GETOWN or F_SETOWN)</li>
<li>Get/set record locks (cmd = F_GETLK, F_SETLK, or F_SETLKW)</li>
</ol>
<h3 id="cmd"><a class="header" href="#cmd">cmd</a></h3>
<table><thead><tr><th>cmd</th><th>descriptors</th></tr></thead><tbody>
<tr><td>F_DUPFD</td><td>Duplicate the file descriptor fd. The new file descriptor is returned as the value of the function. It is the lowest-numbered descriptor that is not already open, and that is greater than or equal to the third argument (taken as an integer). The new descriptor shares the same file table entry as fd. (Refer to Figure 3.9.) But the new descriptor has its own set of file descriptor flags, and its FD_CLOEXEC file descriptor flag is cleared. (This means that the descriptor is left open across an exec, which we discuss in Chapter 8.)</td></tr>
<tr><td>F_DUPFD_CLOEXEC</td><td>Duplicate the file descriptor and set the FD_CLOEXEC file descriptor flag associated with the new descriptor. Returns the new file descriptor.</td></tr>
<tr><td>F_GETFD</td><td>Return the file descriptor flags for fd as the value of the function. Currently, only one file descriptor flag is defined: the FD_CLOEXEC flag.</td></tr>
<tr><td>F_SETFD</td><td>Set the file descriptor flags for fd. The new flag value is set from the third argument (taken as an integer).</td></tr>
<tr><td>F_GETFL</td><td>Return the file status flags for fd as the value of the function. We described the file status flags when we described the open function. They are listed in Figure 3.10. Unfortunately, the five access-mode flags—O_RDONLY, O_WRONLY, O_RDWR, O_EXEC, and O_SEARCH—are not separate bits that can be tested. (As we mentioned earlier, the first three often have the values 0, 1, and 2, respectively, for historical reasons. Also, these five values are mutually exclusive; a file can have only one of them enabled.) Therefore, we must first use the O_ACCMODE mask to obtain the access-mode bits and then compare the result against any of the five values.</td></tr>
<tr><td>F_SETFL</td><td>Set the file status flags to the value of the third argument (taken as an integer). The only flags that can be changed are O_APPEND, O_NONBLOCK, O_SYNC, O_DSYNC, O_RSYNC, O_FSYNC, and O_ASYNC.</td></tr>
<tr><td>F_GETOWN</td><td>Get the process ID or process group ID currently receiving the SIGIO and SIGURG signals. We describe these asynchronous I/O signals in Section 14.5.2.</td></tr>
<tr><td>F_SETOWN</td><td>Set the process ID or process group ID to receive the SIGIO and SIGURG signals. A positive arg specifies a process ID. A negative arg implies a process group ID equal to the absolute value of arg.</td></tr>
</tbody></table>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../system-programming/ch3_10.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../system-programming/ch3_12.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../system-programming/ch3_10.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../system-programming/ch3_12.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
